<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>自动Bing搜索</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        padding: 20px;
      }
      #status {
        margin-top: 20px;
        font-size: 1.2em;
      }
      #searchFrame {
        width: 100%;
        height: 600px;
        border: 1px solid #ccc;
        margin-top: 20px;
      }
      #startButton {
        padding: 10px 20px;
        font-size: 1em;
        cursor: pointer;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <h1>自动Bing搜索</h1>
    <button id="startButton">开始搜索</button>
    <div id="status">点击“开始搜索”按钮以启动搜索。</div>
    <iframe id="searchFrame" src="about:blank"></iframe>

    <script>
      // 关键词搜索库
      const keywords = [
        "人工智能",
        "机器学习",
        "深度学习",
        "自然语言处理",
        "计算机视觉",
        "大数据",
        "云计算",
        "区块链",
        "物联网",
        "5G网络",
        "自动驾驶",
        "量子计算",
      ];

      // 记录已查询的关键词
      let usedKeywords = [];

      // 搜索次数限制
      const maxSearchCount = 5; // 默认搜索5次
      let searchCount = 0;

      // 随机抽取一个未使用过的关键词
      function getRandomKeyword() {
        if (usedKeywords.length === keywords.length) {
          alert("所有关键词已查询完毕！");
          return null;
        }

        let keyword;
        do {
          keyword = keywords[Math.floor(Math.random() * keywords.length)];
        } while (usedKeywords.includes(keyword));

        usedKeywords.push(keyword);
        return keyword;
      }

      // 执行Bing搜索
      function performSearch() {
        if (searchCount >= maxSearchCount) {
          document.getElementById("status").textContent =
            "搜索已完成，共搜索了 " + maxSearchCount + " 次。";
          return;
        }

        const keyword = getRandomKeyword();
        if (!keyword) return;

        const searchUrl = `https://www.bing.com/search?q=${encodeURIComponent(
          keyword
        )}`;
        document.getElementById("searchFrame").src = searchUrl;

        searchCount++;
        document.getElementById(
          "status"
        ).textContent = `正在搜索: ${keyword} (第 ${searchCount} 次，共 ${maxSearchCount} 次)`;

        // 设置下一次搜索的间隔时间（8到10秒）
        const interval = Math.floor(Math.random() * 2000) + 8000; // 8到10秒
        setTimeout(performSearch, interval);
      }

      // 绑定按钮点击事件
      document
        .getElementById("startButton")
        .addEventListener("click", function () {
          // 重置状态
          usedKeywords = [];
          searchCount = 0;
          document.getElementById("status").textContent = "搜索已启动...";
          document.getElementById("searchFrame").src = "about:blank";

          // 开始搜索
          performSearch();
        });
    </script>
  </body>
</html>
